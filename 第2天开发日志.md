下面是你这份 **第二天工作日志与计划** 的详细整理与润色版本，语义更清晰、结构更严谨、便于归档或对外展示：

---

# ✅ 第二天工作计划与开发日志（2025-07-9）

---

## 📅 工作计划

### 1. 数据集成与优化

* 收集并引入更多来自行业领域的文档数据（如 PDF、DOCX、TXT），以扩展和丰富向量知识库的内容覆盖面。
* 优化现有文档解析与向量化处理流程，提高分片质量、文本清洗准确性及整体处理效率，确保知识库中的文档数据高质量、无冗余。

### 2. 答案溯源功能完善

* 增强答案溯源能力，实现**每条回答关联其具体片段来源**，提升回答的可验证性与透明度。
* 在 Gradio 前端页面中集成溯源内容展示模块，使用户能够直接查看生成答案对应的原始文档片段。

### 3. 前端视觉优化与体验提升

* 当前前端仍为基于 Gradio 的简易构建，未来计划采用 **HTML / CSS / JS（前端三件套）** 重构界面，提升整体交互体验。
* 加入文档原文显示功能与跳转定位能力，使用户在检索和溯源时可以直接高亮查看原始上下文内容。

### 4. 文档撰写与项目结构整理

* 编写系统级技术文档（系统架构图、各模块接口说明、调用流程等），支持团队协作与后续维护。
* 编写用户使用手册，包括文档上传、问答查询、关键词搜索、片段删除等功能说明，为用户提供清晰的操作指引。

---

## 🛠️ 今日开发日志

### ✅ 1. 文档上传模块增强

* 增加对 `.docx` 和 `.txt` 格式文档的支持（原仅支持 PDF）。
* 实现文档去重机制：若上传的文档名称已存在于向量数据库中，将自动跳过上传，避免重复数据引入。

### ✅ 2. 批量删除功能实现

* 支持按单个编号删除，如：`3`
* 支持多编号删除，如：`1,4,7`
* 支持区间删除，如：`2-5`
* 实现自动解析与校验机制，保障删除指令的格式与边界合法性。

### ✅ 3. 前端美化初步完成（基于 Gradio）

* 调整页面主色调为 **浅蓝 + 深蓝按钮风格**，提升视觉统一性与专业感。
* 实现了按钮圆角（24px）、悬浮变色、禁用状态等交互效果。
* 使用 `gr.HTML()` + 自定义 CSS 代替 `gr.Markdown()` 实现更细粒度的排版控制。

### ✅ 4. Markdown 渲染问题深入优化

* 模型返回原始 Markdown 内容，但使用 `gr.Markdown()` 渲染存在 **空行过多、格式错乱、分割线过多** 等问题。
* 初步尝试使用正则表达式在后端进行预处理，压缩空白行、移除多余格式符（如 `---`、`___`）。
* 经验证，`gr.Markdown()` 内部仍会插入空行，无法完全满足控制要求。
* 最终改为 **自定义 HTML + CSS 渲染方案**：

  * 将 Markdown 转为 HTML，再嵌入自定义 `<div>` 容器中；
  * 编写 CSS 样式，精确控制段落、标题、列表的间距与字体；
  * 使用 `"楷体"` 字体提升可读性和正式感；
  * 最终显著提升了 Markdown 渲染的美观性与一致性。

### ✅ 5. 布局优化：数据库管理三列对齐

* 原页面中，文档上传 / 文档列表 / 删除模块三列内容存在 **高度不一致、布局不整齐** 问题。
* 通过统一 `Textbox` 的 `lines` 设置、按钮高度统一、布局调整等方式，使三列内容 **视觉上高度对齐**，提升整体排版规整性与用户体验。

---

## ✅ 总结与展望

本日主要完成了功能增强、前端美化和 Markdown 渲染优化三大方面的工作。后续将进一步：

* 强化文档展示与跳转能力；
* 实现前端 JS 定位跳转原文功能；
* 逐步将前端迁移至 HTML+JS+CSS 独立架构。

项目已逐步具备实用性与可扩展性，未来可进一步考虑部署、接入更多行业数据、优化检索模型等方向。
